

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Atmospheric Turbulence &mdash; AOtools 0.1.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="AOtools 0.1.0 documentation" href="index.html"/>
        <link rel="next" title="Image Processing" href="image_processing.html"/>
        <link rel="prev" title="Introduction" href="introduction.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> AOtools
          

          
          </a>

          
            
            
              <div class="version">
                0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Atmospheric Turbulence</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#finite-phase-screens">Finite Phase Screens</a></li>
<li class="toctree-l2"><a class="reference internal" href="#infinite-phase-screens">Infinite Phase Screens</a></li>
<li class="toctree-l2"><a class="reference internal" href="#slope-covariance-matrix-generation">Slope Covariance Matrix Generation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#temporal-power-spectra">Temporal Power Spectra</a></li>
<li class="toctree-l2"><a class="reference internal" href="#atmospheric-parameter-conversions">Atmospheric Parameter Conversions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="image_processing.html">Image Processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="zernike.html">Circular Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="pupil.html">Telescope Pupils</a></li>
<li class="toctree-l1"><a class="reference internal" href="wfs.html">Wavefront Sensors</a></li>
<li class="toctree-l1"><a class="reference internal" href="opticalpropagation.html">Optical Propagation</a></li>
<li class="toctree-l1"><a class="reference internal" href="astronomy.html">Astronomical Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="fft.html">Normalised Fourier Transforms</a></li>
<li class="toctree-l1"><a class="reference internal" href="interpolation.html">Interpolation</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">AOtools</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Atmospheric Turbulence</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/turbulence.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-aotools.turbulence">
<span id="atmospheric-turbulence"></span><h1>Atmospheric Turbulence<a class="headerlink" href="#module-aotools.turbulence" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="aotools.turbulence.phase_covariance">
<code class="descclassname">aotools.turbulence.</code><code class="descname">phase_covariance</code><span class="sig-paren">(</span><em>r</em>, <em>r0</em>, <em>L0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aotools/turbulence/turb.html#phase_covariance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aotools.turbulence.phase_covariance" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the phase covariance between two points seperated by <cite>r</cite>,
in turbulence with a given <cite>r0 and `L0</cite>.
Uses equation 5 from Assemat and Wilson, 2006.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>r</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a><em>, </em><em>ndarray</em>) – Seperation between points in metres (can be ndarray)</li>
<li><strong>r0</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Fried parameter of turbulence in metres</li>
<li><strong>L0</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Outer scale of turbulence in metres</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<span class="target" id="module-aotools.turbulence.phasescreen"></span><div class="section" id="finite-phase-screens">
<h2>Finite Phase Screens<a class="headerlink" href="#finite-phase-screens" title="Permalink to this headline">¶</a></h2>
<p>Creation of phase screens with Von Karmen Statistics.</p>
<dl class="function">
<dt id="aotools.turbulence.phasescreen.ft_phase_screen">
<code class="descclassname">aotools.turbulence.phasescreen.</code><code class="descname">ft_phase_screen</code><span class="sig-paren">(</span><em>r0</em>, <em>N</em>, <em>delta</em>, <em>L0</em>, <em>l0</em>, <em>FFT=None</em>, <em>seed=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aotools/turbulence/phasescreen.html#ft_phase_screen"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aotools.turbulence.phasescreen.ft_phase_screen" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a random phase screen with Von Karmen statistics.
(Schmidt 2010)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>r0</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – r0 parameter of scrn in metres</li>
<li><strong>N</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Size of phase scrn in pxls</li>
<li><strong>delta</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – size in Metres of each pxl</li>
<li><strong>L0</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Size of outer-scale in metres</li>
<li><strong>l0</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – inner scale in metres</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">numpy array representing phase screen</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="aotools.turbulence.phasescreen.ft_sh_phase_screen">
<code class="descclassname">aotools.turbulence.phasescreen.</code><code class="descname">ft_sh_phase_screen</code><span class="sig-paren">(</span><em>r0</em>, <em>N</em>, <em>delta</em>, <em>L0</em>, <em>l0</em>, <em>FFT=None</em>, <em>seed=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aotools/turbulence/phasescreen.html#ft_sh_phase_screen"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aotools.turbulence.phasescreen.ft_sh_phase_screen" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a random phase screen with Von Karmen statistics with added
sub-harmonics to augment tip-tilt modes.
(Schmidt 2010)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>r0</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – r0 parameter of scrn in metres</li>
<li><strong>N</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Size of phase scrn in pxls</li>
<li><strong>delta</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – size in Metres of each pxl</li>
<li><strong>L0</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Size of outer-scale in metres</li>
<li><strong>l0</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – inner scale in metres</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">numpy array representing phase screen</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="aotools.turbulence.phasescreen.ift2">
<code class="descclassname">aotools.turbulence.phasescreen.</code><code class="descname">ift2</code><span class="sig-paren">(</span><em>G</em>, <em>delta_f</em>, <em>FFT=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aotools/turbulence/phasescreen.html#ift2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aotools.turbulence.phasescreen.ift2" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper for inverse fourier transform</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>G</strong> – data to transform</li>
<li><strong>delta_f</strong> – pixel seperation</li>
<li><strong>FFT</strong> (<em>FFT object</em><em>, </em><em>optional</em>) – An accelerated FFT object</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<span class="target" id="module-aotools.turbulence.infinitephasescreen"></span><div class="section" id="infinite-phase-screens">
<h2>Infinite Phase Screens<a class="headerlink" href="#infinite-phase-screens" title="Permalink to this headline">¶</a></h2>
<p>An implementation of the “infinite phase screen”, as deduced by Francois Assemat and Richard W. Wilson, 2006.</p>
<dl class="class">
<dt id="aotools.turbulence.infinitephasescreen.PhaseScreenVonKarman">
<em class="property">class </em><code class="descclassname">aotools.turbulence.infinitephasescreen.</code><code class="descname">PhaseScreenVonKarman</code><span class="sig-paren">(</span><em>nx_size</em>, <em>pixel_scale</em>, <em>r0</em>, <em>L0</em>, <em>random_seed=None</em>, <em>n_columns=2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aotools/turbulence/infinitephasescreen.html#PhaseScreenVonKarman"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aotools.turbulence.infinitephasescreen.PhaseScreenVonKarman" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">aotools.turbulence.infinitephasescreen.PhaseScreen</span></code></p>
<p>A “Phase Screen” for use in AO simulation with Von Karmon statistics.</p>
<p>This represents the phase addition light experiences when passing through atmospheric
turbulence. Unlike other phase screen generation techniques that translate a large static
screen, this method keeps a small section of phase, and extends it as neccessary for as many
steps as required. This can significantly reduce memory consuption at the expense of more
processing power required.</p>
<p>The technique is described in a paper by Assemat and Wilson, 2006. It essentially assumes that
there are two matrices, “A” and “B”, that can be used to extend an existing phase screen.
A single row or column of new phase can be represented by</p>
<blockquote>
<div>X = A.Z + B.b</div></blockquote>
<p>where X is the new phase vector, Z is some number of columns of the existing screen,
and b is a random vector with gaussian statistics.</p>
<p>This object calculates the A and B matrices using an expression of the phase covariance when it
is initialised. Calculating A is straightforward through the relationship:</p>
<blockquote>
<div>A =  Cov_xz . (Cov_zz)^(-1).</div></blockquote>
<p>B is less trivial.</p>
<blockquote>
<div>BB^t = Cov_xx - A.Cov_zx</div></blockquote>
<p>(where B^t is the transpose of B) is a symmetric matrix, hence B can be expressed as</p>
<blockquote>
<div>B = UL,</div></blockquote>
<p>where U and L are obtained from the svd for BB^t</p>
<blockquote>
<div>U, w, U^t = svd(BB^t)</div></blockquote>
<p>L is a diagonal matrix where the diagonal elements are w^(1/2).</p>
<p>On initialisation an initial phase screen is calculated using an FFT based method.
When ‘addRows’ is called, a new vector of phase is added to the phase screen using <cite>nCols</cite>
columns of previous phase. Assemat &amp; Wilson claim that two columns are adequate for good
atmospheric statistics. The phase in the screen data is always accessed as <cite>&lt;phasescreen&gt;.scrn</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>nx_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Size of phase screen (NxN)</li>
<li><strong>pixel_scale</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Size of each phase pixel in metres</li>
<li><strong>r0</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – fried parameter (metres)</li>
<li><strong>L0</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Outer scale (metres)</li>
<li><strong>n_columns</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>optional</em>) – Number of columns to use to continue screen, default is 2</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="aotools.turbulence.infinitephasescreen.PhaseScreenVonKarman.set_stencil_coords">
<code class="descname">set_stencil_coords</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/aotools/turbulence/infinitephasescreen.html#PhaseScreenVonKarman.set_stencil_coords"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aotools.turbulence.infinitephasescreen.PhaseScreenVonKarman.set_stencil_coords" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the Z coordinates, sections of the phase screen that will be used to create new phase</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="aotools.turbulence.infinitephasescreen.PhaseScreenKolmogorov">
<em class="property">class </em><code class="descclassname">aotools.turbulence.infinitephasescreen.</code><code class="descname">PhaseScreenKolmogorov</code><span class="sig-paren">(</span><em>nx_size</em>, <em>pixel_scale</em>, <em>r0</em>, <em>L0</em>, <em>random_seed=None</em>, <em>stencil_length_factor=4</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aotools/turbulence/infinitephasescreen.html#PhaseScreenKolmogorov"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aotools.turbulence.infinitephasescreen.PhaseScreenKolmogorov" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">aotools.turbulence.infinitephasescreen.PhaseScreen</span></code></p>
<p>A “Phase Screen” for use in AO simulation using the Fried method for Kolmogorov turbulence.</p>
<p>This represents the phase addition light experiences when passing through atmospheric
turbulence. Unlike other phase screen generation techniques that translate a large static
screen, this method keeps a small section of phase, and extends it as neccessary for as many
steps as required. This can significantly reduce memory consuption at the expense of more
processing power required.</p>
<p>The technique is described in a paper by Assemat and Wilson, 2006 and expanded upon by Fried, 2008.
It essentially assumes that there are two matrices, “A” and “B”,
that can be used to extend an existing phase screen.
A single row or column of new phase can be represented by</p>
<blockquote>
<div>X = A.Z + B.b</div></blockquote>
<p>where X is the new phase vector, Z is some data from the existing screen,
and b is a random vector with gaussian statistics.</p>
<p>This object calculates the A and B matrices using an expression of the phase covariance when it
is initialised. Calculating A is straightforward through the relationship:</p>
<blockquote>
<div>A =  Cov_xz . (Cov_zz)^(-1).</div></blockquote>
<p>B is less trivial.</p>
<blockquote>
<div>BB^t = Cov_xx - A.Cov_zx</div></blockquote>
<p>(where B^t is the transpose of B) is a symmetric matrix, hence B can be expressed as</p>
<blockquote>
<div>B = UL,</div></blockquote>
<p>where U and L are obtained from the svd for BB^t</p>
<blockquote>
<div>U, w, U^t = svd(BB^t)</div></blockquote>
<p>L is a diagonal matrix where the diagonal elements are w^(1/2).</p>
<p>The Z data is taken from points in a “stencil” defined by Fried that samples the entire screen.
An additional “reference point” is also considered, that is picked from a point separate from teh stencil
and applied on each iteration such that the new phase equation becomes:</p>
<p>On initialisation an initial phase screen is calculated using an FFT based method.
When ‘addRows’ is called, a new vector of phase is added to the phase screen.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>nx_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Size of phase screen (NxN)</li>
<li><strong>pixel_scale</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Size of each phase pixel in metres</li>
<li><strong>r0</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – fried parameter (metres)</li>
<li><strong>L0</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Outer scale (metres)</li>
<li><strong>random_seed</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>optional</em>) – seed for the random number generator</li>
<li><strong>stencil_length_factor</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>optional</em>) – How much longer is the stencil than the desired phase? default is 4</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="aotools.turbulence.infinitephasescreen.PhaseScreenKolmogorov.get_new_row">
<code class="descname">get_new_row</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/aotools/turbulence/infinitephasescreen.html#PhaseScreenKolmogorov.get_new_row"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aotools.turbulence.infinitephasescreen.PhaseScreenKolmogorov.get_new_row" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="aotools.turbulence.infinitephasescreen.PhaseScreenKolmogorov.set_stencil_coords">
<code class="descname">set_stencil_coords</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/aotools/turbulence/infinitephasescreen.html#PhaseScreenKolmogorov.set_stencil_coords"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aotools.turbulence.infinitephasescreen.PhaseScreenKolmogorov.set_stencil_coords" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the Z coordinates, sections of the phase screen that will be used to create new phase</p>
</dd></dl>

</dd></dl>

</div>
<span class="target" id="module-aotools.turbulence.slopecovariance"></span><div class="section" id="slope-covariance-matrix-generation">
<h2>Slope Covariance Matrix Generation<a class="headerlink" href="#slope-covariance-matrix-generation" title="Permalink to this headline">¶</a></h2>
<p>Slope covariance matrix routines for AO systems observing through Von Karmon turbulence. Such matrices have a variety
of uses, though they are especially useful for creating ‘tomographic reconstructors’ that can reconstruct some ‘psuedo’
WFS measurements in a required direction (where there might be an interesting science target but no guide stars),
given some actual measurements in other directions (where the some suitable guide stars are).</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This code has been tested qualitatively and seems OK, but needs more rigorous testing.</p>
</div>
<p><em>Code author: Andrew Reeves &lt;<a class="reference external" href="mailto:a&#46;p&#46;reeves&#37;&#52;&#48;durham&#46;ac&#46;uk">a<span>&#46;</span>p<span>&#46;</span>reeves<span>&#64;</span>durham<span>&#46;</span>ac<span>&#46;</span>uk</a>&gt;</em></p>
<dl class="class">
<dt id="aotools.turbulence.slopecovariance.CovarianceMatrix">
<em class="property">class </em><code class="descclassname">aotools.turbulence.slopecovariance.</code><code class="descname">CovarianceMatrix</code><span class="sig-paren">(</span><em>n_wfs</em>, <em>pupil_masks</em>, <em>telescope_diameter</em>, <em>subap_diameters</em>, <em>gs_altitudes</em>, <em>gs_positions</em>, <em>wfs_wavelengths</em>, <em>n_layers</em>, <em>layer_altitudes</em>, <em>layer_r0s</em>, <em>layer_L0s</em>, <em>threads=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aotools/turbulence/slopecovariance.html#CovarianceMatrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aotools.turbulence.slopecovariance.CovarianceMatrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>A creator of slope covariance matrices in Von Karmon turbulence, based on the paper by Martin et al, SPIE, 2012.</p>
<p>Given a list of paramters describing an AO WFS system and the atmosphere above the telescope, this class can
compute the covariance matrix between all the WFS measurements. This can support LGS sources that exist at a
finite altitude. When computing the covariance matrix, Python’s multiprocessing module is used to spread the work
between different processes and processing cores.</p>
<p>On initialisation, this class performs some initial calculations and parameter sorting. To create the
covariance matrix run the <code class="docutils literal notranslate"><span class="pre">make_covariace_matrix</span></code> method. This may take some time depending on your paramters…</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>n_wfs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Number of wavefront sensors present.</li>
<li><strong>pupil_masks</strong> (<em>ndarray</em>) – A map of the pupil for each WFS which is nx_subaps by ny_subaps. 1 if subap active, 0 if not.</li>
<li><strong>telescope_diameter</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Diameter of the telescope</li>
<li><strong>subap_diameters</strong> (<em>ndarray</em>) – The diameter of the sub-apertures for each WFS in metres</li>
<li><strong>gs_altitudes</strong> (<em>ndarray</em>) – Reciprocal (1/metres) of the Guide star alitude for each WFS</li>
<li><strong>gs_positions</strong> (<em>ndarray</em>) – X,Y position of each WFS in arcsecs. Array shape (Wfs, 2)</li>
<li><strong>wfs_wavelengths</strong> (<em>ndarray</em>) – Wavelength each WFS observes</li>
<li><strong>n_layers</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – The number of atmospheric turbulence layers</li>
<li><strong>layer_altitudes</strong> (<em>ndarray</em>) – The altitude of each turbulence layer in meters</li>
<li><strong>layer_r0s</strong> (<em>ndarray</em>) – The Fried parameter of each turbulence layer</li>
<li><strong>layer_L0s</strong> (<em>ndarray</em>) – The outer-scale of each layer in metres</li>
<li><strong>threads</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>optional</em>) – Number of processes to use for calculation. default is 1</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="aotools.turbulence.slopecovariance.CovarianceMatrix.make_covariance_matrix">
<code class="descname">make_covariance_matrix</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/aotools/turbulence/slopecovariance.html#CovarianceMatrix.make_covariance_matrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aotools.turbulence.slopecovariance.CovarianceMatrix.make_covariance_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate and build the covariance matrix</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Covariance Matrix</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="aotools.turbulence.slopecovariance.CovarianceMatrix.make_tomographic_reconstructor">
<code class="descname">make_tomographic_reconstructor</code><span class="sig-paren">(</span><em>svd_conditioning=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aotools/turbulence/slopecovariance.html#CovarianceMatrix.make_tomographic_reconstructor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aotools.turbulence.slopecovariance.CovarianceMatrix.make_tomographic_reconstructor" title="Permalink to this definition">¶</a></dt>
<dd><p>Creats a tomohraphic reconstructor from the covariance matrix as in Vidal, 2010.
See the documentation for the function <cite>create_tomographic_covariance_reconstructor</cite> in this module.
Assumes the 1st WFS given is the one for which reconstruction is required to.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>svd_conditioning</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Conditioning for the SVD used in inversion.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">A tomohraphic reconstructor.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="aotools.turbulence.slopecovariance.calculate_structure_function">
<code class="descclassname">aotools.turbulence.slopecovariance.</code><code class="descname">calculate_structure_function</code><span class="sig-paren">(</span><em>phase</em>, <em>nbOfPoint=None</em>, <em>step=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aotools/turbulence/slopecovariance.html#calculate_structure_function"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aotools.turbulence.slopecovariance.calculate_structure_function" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the structure function of an 2D array, along the first dimension.
SF defined as sf[j]= &lt; (phase - phase_shifted_by_j)^2 &gt;
Translated from a YAO function.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>phase</strong> (<em>ndarray</em><em>, </em><em>2d</em>) – 2d-array</li>
<li><strong>nbOfPoint</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – final size of the structure function vector. Default is phase.shape[1] / 4</li>
<li><strong>step</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – step in pixel when computing the sf. (step * sampling_phase) gives the sf sampling in meters. Default is 1</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">values for the structure function of the data.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray, <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)">float</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="aotools.turbulence.slopecovariance.calculate_wfs_seperations">
<code class="descclassname">aotools.turbulence.slopecovariance.</code><code class="descname">calculate_wfs_seperations</code><span class="sig-paren">(</span><em>n_subaps1</em>, <em>n_subaps2</em>, <em>wfs1_positions</em>, <em>wfs2_positions</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aotools/turbulence/slopecovariance.html#calculate_wfs_seperations"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aotools.turbulence.slopecovariance.calculate_wfs_seperations" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the seperation between all sub-apertures in two WFSs</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>n_subaps1</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Number of sub-apertures in WFS 1</li>
<li><strong>n_subaps2</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Number of sub-apertures in WFS 2</li>
<li><strong>wfs1_positions</strong> (<em>ndarray</em>) – Array of the X, Y positions of the centre of each sub-aperture with respect to the centre of the telescope pupil</li>
<li><strong>wfs2_positions</strong> (<em>ndarray</em>) – Array of the X, Y positions of the centre of each sub-aperture with respect to the centre of the telescope pupil</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">2-D Array of sub-aperture seperations</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="aotools.turbulence.slopecovariance.compute_covariance_xx">
<code class="descclassname">aotools.turbulence.slopecovariance.</code><code class="descname">compute_covariance_xx</code><span class="sig-paren">(</span><em>seperation</em>, <em>subap1_diam</em>, <em>subap2_diam</em>, <em>r0</em>, <em>L0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aotools/turbulence/slopecovariance.html#compute_covariance_xx"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aotools.turbulence.slopecovariance.compute_covariance_xx" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="aotools.turbulence.slopecovariance.compute_covariance_xy">
<code class="descclassname">aotools.turbulence.slopecovariance.</code><code class="descname">compute_covariance_xy</code><span class="sig-paren">(</span><em>seperation</em>, <em>subap1_diam</em>, <em>subap2_diam</em>, <em>r0</em>, <em>L0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aotools/turbulence/slopecovariance.html#compute_covariance_xy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aotools.turbulence.slopecovariance.compute_covariance_xy" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="aotools.turbulence.slopecovariance.compute_covariance_yy">
<code class="descclassname">aotools.turbulence.slopecovariance.</code><code class="descname">compute_covariance_yy</code><span class="sig-paren">(</span><em>seperation</em>, <em>subap1_diam</em>, <em>subap2_diam</em>, <em>r0</em>, <em>L0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aotools/turbulence/slopecovariance.html#compute_covariance_yy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aotools.turbulence.slopecovariance.compute_covariance_yy" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="aotools.turbulence.slopecovariance.create_tomographic_covariance_reconstructor">
<code class="descclassname">aotools.turbulence.slopecovariance.</code><code class="descname">create_tomographic_covariance_reconstructor</code><span class="sig-paren">(</span><em>covariance_matrix</em>, <em>n_onaxis_subaps</em>, <em>svd_conditioning=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aotools/turbulence/slopecovariance.html#create_tomographic_covariance_reconstructor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aotools.turbulence.slopecovariance.create_tomographic_covariance_reconstructor" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates a tomographic reconstructor using the method of Vidal, JOSA A, 2010.</p>
<p>Uses a slope covariance matrix to generate a reconstruction matrix that will convert a collection of measurements
from WFSs observing in a variety of directions (the “off-axis” directions) to the measurements that would have been
observed by a WFS observing in a different direction (the “on-axis” direction.
The given covariance matrix must include the covariance between all WFS measurements,
including the “psuedo” WFS pointing in the on-axis direction.
It is assumed that the covariance of measurements from this on-axis direction are first in the covariance matrix.</p>
<p>To create the tomographic reconstructor it is neccessary to invert the covariance matrix between off-axis WFS
measurements. An SVD based psueod inversion is used for this (<cite>numpy.linalg.pinv</cite>). A conditioning to this SVD may
be required to filter potentially unwanted modes.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>covariance_matrix</strong> (<em>ndarray</em>) – A covariance matrix between WFSs</li>
<li><strong>n_onaxis_subaps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Number of sub-aperture in on-axis WFS</li>
<li><strong>svd_conditioning</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a><em>, </em><em>optional</em>) – Conditioning for SVD inversion (default is 0)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Returns:</p>
</dd></dl>

<dl class="function">
<dt id="aotools.turbulence.slopecovariance.mirror_covariance_matrix">
<code class="descclassname">aotools.turbulence.slopecovariance.</code><code class="descname">mirror_covariance_matrix</code><span class="sig-paren">(</span><em>cov_mat</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aotools/turbulence/slopecovariance.html#mirror_covariance_matrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aotools.turbulence.slopecovariance.mirror_covariance_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Mirrors a covariance matrix around the axis of the diagonal.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>cov_mat</strong> (<em>ndarray</em>) – The covariance matrix to mirror</li>
<li><strong>n_subaps</strong> (<em>ndarray</em>) – Number of sub-aperture in each WFS</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="aotools.turbulence.slopecovariance.structure_function_kolmogorov">
<code class="descclassname">aotools.turbulence.slopecovariance.</code><code class="descname">structure_function_kolmogorov</code><span class="sig-paren">(</span><em>separation</em>, <em>r0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aotools/turbulence/slopecovariance.html#structure_function_kolmogorov"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aotools.turbulence.slopecovariance.structure_function_kolmogorov" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the Kolmogorov phase structure function</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>separation</strong> (<em>ndarray</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – float or array of data representing
separations between points</li>
<li><strong>r0</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Fried parameter for atmosphere</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Structure function for separation(s)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray, <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)">float</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="aotools.turbulence.slopecovariance.structure_function_vk">
<code class="descclassname">aotools.turbulence.slopecovariance.</code><code class="descname">structure_function_vk</code><span class="sig-paren">(</span><em>seperation</em>, <em>r0</em>, <em>L0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aotools/turbulence/slopecovariance.html#structure_function_vk"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aotools.turbulence.slopecovariance.structure_function_vk" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the Von Karmon structure function of atmospheric turbulence</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>seperation</strong> (<em>ndarray</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – float or array of data representing seperations between points</li>
<li><strong>r0</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Fried parameter for atmosphere</li>
<li><strong>L0</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Outer scale of turbulence</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Structure function for seperation(s)</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray, <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)">float</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="aotools.turbulence.slopecovariance.wfs_covariance">
<code class="descclassname">aotools.turbulence.slopecovariance.</code><code class="descname">wfs_covariance</code><span class="sig-paren">(</span><em>n_subaps1</em>, <em>n_subaps2</em>, <em>wfs1_positions</em>, <em>wfs2_positions</em>, <em>wfs1_diam</em>, <em>wfs2_diam</em>, <em>r0</em>, <em>L0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aotools/turbulence/slopecovariance.html#wfs_covariance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aotools.turbulence.slopecovariance.wfs_covariance" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the covariance between 2 WFSs</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>n_subaps1</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – number of sub-apertures in WFS 1</li>
<li><strong>n_subaps2</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – number of sub-apertures in WFS 1</li>
<li><strong>wfs1_positions</strong> (<em>ndarray</em>) – Central position of each sub-apeture from telescope centre for WFS 1</li>
<li><strong>wfs2_positions</strong> (<em>ndarray</em>) – Central position of each sub-apeture from telescope centre for WFS 2</li>
<li><strong>wfs1_diam</strong> – Diameter of WFS 1 sub-apertures</li>
<li><strong>wfs2_diam</strong> – Diameter of WFS 2 sub-apertures</li>
<li><strong>r0</strong> – Fried parameter of turbulence</li>
<li><strong>L0</strong> – Outer scale of turbulence</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">slope covariance of X with X , slope covariance of Y with Y, slope covariance of X with Y</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="aotools.turbulence.slopecovariance.wfs_covariance_mpwrap">
<code class="descclassname">aotools.turbulence.slopecovariance.</code><code class="descname">wfs_covariance_mpwrap</code><span class="sig-paren">(</span><em>args</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aotools/turbulence/slopecovariance.html#wfs_covariance_mpwrap"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aotools.turbulence.slopecovariance.wfs_covariance_mpwrap" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<span class="target" id="module-aotools.turbulence.temporal_ps"></span><div class="section" id="temporal-power-spectra">
<h2>Temporal Power Spectra<a class="headerlink" href="#temporal-power-spectra" title="Permalink to this headline">¶</a></h2>
<p>Turbulence gradient temporal power spectra calculation and plotting</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">author:</th><td class="field-body">Andrew Reeves</td>
</tr>
<tr class="field-even field"><th class="field-name">date:</th><td class="field-body">September 2016</td>
</tr>
</tbody>
</table>
<dl class="function">
<dt id="aotools.turbulence.temporal_ps.calc_slope_temporalps">
<code class="descclassname">aotools.turbulence.temporal_ps.</code><code class="descname">calc_slope_temporalps</code><span class="sig-paren">(</span><em>slope_data</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aotools/turbulence/temporal_ps.html#calc_slope_temporalps"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aotools.turbulence.temporal_ps.calc_slope_temporalps" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the temporal power spectra of the loaded centroid data.</p>
<p>Calculates the Fourier transform over the number frames of the centroid
data, then returns the square of the  mean of all sub-apertures, for x
and y. This is a temporal power spectra of the slopes, and should adhere
to a -11/3 power law for the slopes in the wind direction, and -14/3 in
the direction tranverse to the wind direction. See Conan, 1995 for more.</p>
<p>The phase slope data should be split into X and Y components, with all X data first, then Y (or visa-versa).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>slope_data</strong> (<em>ndarray</em>) – 2-d array of shape (…, nFrames, nCentroids)</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The temporal power spectra of the data for X and Y components.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">ndarray</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="aotools.turbulence.temporal_ps.fit_tps">
<code class="descclassname">aotools.turbulence.temporal_ps.</code><code class="descname">fit_tps</code><span class="sig-paren">(</span><em>tps</em>, <em>t_axis</em>, <em>D</em>, <em>V_guess=10</em>, <em>f_noise_guess=20</em>, <em>A_guess=9</em>, <em>tps_err=None</em>, <em>plot=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aotools/turbulence/temporal_ps.html#fit_tps"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aotools.turbulence.temporal_ps.fit_tps" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs minimization routines to get t0.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>tps</strong> (<em>ndarray</em>) – The temporal power spectrum to fit</li>
<li><strong>axis</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – fit parallel (‘par’) or perpendicular (‘per’) to wind direction</li>
<li><strong>D</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – (Sub-)Aperture diameter</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Returns:</p>
</dd></dl>

<dl class="function">
<dt id="aotools.turbulence.temporal_ps.get_tps_time_axis">
<code class="descclassname">aotools.turbulence.temporal_ps.</code><code class="descname">get_tps_time_axis</code><span class="sig-paren">(</span><em>frame_rate</em>, <em>n_frames</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aotools/turbulence/temporal_ps.html#get_tps_time_axis"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aotools.turbulence.temporal_ps.get_tps_time_axis" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>frame_rate</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Frame rate of detector observing slope gradients (Hz)</li>
<li><strong>n_frames</strong> – (int): Number of frames used for temporal power spectrum</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Time values for temporal power spectra plots</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ndarray</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="aotools.turbulence.temporal_ps.plot_tps">
<code class="descclassname">aotools.turbulence.temporal_ps.</code><code class="descname">plot_tps</code><span class="sig-paren">(</span><em>slope_data</em>, <em>frame_rate</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aotools/turbulence/temporal_ps.html#plot_tps"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aotools.turbulence.temporal_ps.plot_tps" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates a plot of the temporal power spectrum/a for a data set of phase gradients</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>slope_data</strong> (<em>ndarray</em>) – 2-d array of shape (…, nFrames, nCentroids)</li>
<li><strong>frame_rate</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Frame rate of detector observing slope gradients (Hz)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The computed temporal power spectrum/a, and the time axis data</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.7)">tuple</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<span class="target" id="module-aotools.turbulence.atmos_conversions"></span><div class="section" id="atmospheric-parameter-conversions">
<h2>Atmospheric Parameter Conversions<a class="headerlink" href="#atmospheric-parameter-conversions" title="Permalink to this headline">¶</a></h2>
<p>Functions for converting between different atmospheric parameters,</p>
<dl class="function">
<dt id="aotools.turbulence.atmos_conversions.cn2_to_r0">
<code class="descclassname">aotools.turbulence.atmos_conversions.</code><code class="descname">cn2_to_r0</code><span class="sig-paren">(</span><em>cn2</em>, <em>lamda=5e-07</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aotools/turbulence/atmos_conversions.html#cn2_to_r0"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aotools.turbulence.atmos_conversions.cn2_to_r0" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates r0 from the integrated Cn2 value</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>cn2</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – integrated Cn2 value in m^2/3</li>
<li><strong>lamda</strong> – wavelength</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">r0 in cm</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="aotools.turbulence.atmos_conversions.cn2_to_seeing">
<code class="descclassname">aotools.turbulence.atmos_conversions.</code><code class="descname">cn2_to_seeing</code><span class="sig-paren">(</span><em>cn2</em>, <em>lamda=5e-07</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aotools/turbulence/atmos_conversions.html#cn2_to_seeing"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aotools.turbulence.atmos_conversions.cn2_to_seeing" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the seeing angle from the integrated Cn2 value</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>cn2</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – integrated Cn2 value in m^2/3</li>
<li><strong>lamda</strong> – wavelength</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">seeing angle in arcseconds</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="aotools.turbulence.atmos_conversions.coherenceTime">
<code class="descclassname">aotools.turbulence.atmos_conversions.</code><code class="descname">coherenceTime</code><span class="sig-paren">(</span><em>cn2</em>, <em>v</em>, <em>lamda=5e-07</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aotools/turbulence/atmos_conversions.html#coherenceTime"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aotools.turbulence.atmos_conversions.coherenceTime" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the coherence time from profiles of the Cn2 and wind velocity</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>cn2</strong> (<em>array</em>) – Cn2 profile in m^2/3</li>
<li><strong>v</strong> (<em>array</em>) – profile of wind velocity, same altitude scale as cn2</li>
<li><strong>lamda</strong> – wavelength</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">coherence time in seconds</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="aotools.turbulence.atmos_conversions.isoplanaticAngle">
<code class="descclassname">aotools.turbulence.atmos_conversions.</code><code class="descname">isoplanaticAngle</code><span class="sig-paren">(</span><em>cn2</em>, <em>h</em>, <em>lamda=5e-07</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aotools/turbulence/atmos_conversions.html#isoplanaticAngle"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aotools.turbulence.atmos_conversions.isoplanaticAngle" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the isoplanatic angle from the Cn2 profile</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>cn2</strong> (<em>array</em>) – Cn2 profile in m^2/3</li>
<li><strong>h</strong> (<em>Array</em>) – Altitude levels of cn2 profile in m</li>
<li><strong>lamda</strong> – wavelength</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">isoplanatic angle in arcseconds</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="aotools.turbulence.atmos_conversions.r0_from_slopes">
<code class="descclassname">aotools.turbulence.atmos_conversions.</code><code class="descname">r0_from_slopes</code><span class="sig-paren">(</span><em>slopes</em>, <em>wavelength</em>, <em>subapDiam</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aotools/turbulence/atmos_conversions.html#r0_from_slopes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aotools.turbulence.atmos_conversions.r0_from_slopes" title="Permalink to this definition">¶</a></dt>
<dd><p>Measures the value of R0 from a set of WFS slopes.</p>
<p>Uses the equation in Saint Jaques, 1998, PhD Thesis, Appendix A to calculate the value of atmospheric seeing parameter, r0, that would result in the variance of the given slopes.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>slopes</strong> (<em>ndarray</em>) – A 3-d set of slopes in radians, of shape (dimension, nSubaps, nFrames)</li>
<li><strong>wavelength</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – The wavelegnth of the light observed</li>
<li><strong>subapDiam</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">An estimate of r0 for that dataset.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)">float</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="aotools.turbulence.atmos_conversions.r0_to_cn2">
<code class="descclassname">aotools.turbulence.atmos_conversions.</code><code class="descname">r0_to_cn2</code><span class="sig-paren">(</span><em>r0</em>, <em>lamda=5e-07</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aotools/turbulence/atmos_conversions.html#r0_to_cn2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aotools.turbulence.atmos_conversions.r0_to_cn2" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates integrated Cn2 value from r0</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>r0</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – r0 in cm</li>
<li><strong>lamda</strong> – wavelength</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">integrated Cn2 value in m^2/3</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">cn2 (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)">float</a>)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="aotools.turbulence.atmos_conversions.r0_to_seeing">
<code class="descclassname">aotools.turbulence.atmos_conversions.</code><code class="descname">r0_to_seeing</code><span class="sig-paren">(</span><em>r0</em>, <em>lamda=5e-07</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aotools/turbulence/atmos_conversions.html#r0_to_seeing"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aotools.turbulence.atmos_conversions.r0_to_seeing" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the seeing angle from r0</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>r0</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Freid’s parameter in cm</li>
<li><strong>lamda</strong> – wavelength</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">seeing angle in arcseconds</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="aotools.turbulence.atmos_conversions.seeing_to_cn2">
<code class="descclassname">aotools.turbulence.atmos_conversions.</code><code class="descname">seeing_to_cn2</code><span class="sig-paren">(</span><em>seeing</em>, <em>lamda=5e-07</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aotools/turbulence/atmos_conversions.html#seeing_to_cn2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aotools.turbulence.atmos_conversions.seeing_to_cn2" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the integrated Cn2 value from the seeing</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>seeing</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – seeing in arcseconds</li>
<li><strong>lamda</strong> – wavelength</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">integrated Cn2 value in m^2/3</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="aotools.turbulence.atmos_conversions.seeing_to_r0">
<code class="descclassname">aotools.turbulence.atmos_conversions.</code><code class="descname">seeing_to_r0</code><span class="sig-paren">(</span><em>seeing</em>, <em>lamda=5e-07</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aotools/turbulence/atmos_conversions.html#seeing_to_r0"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aotools.turbulence.atmos_conversions.seeing_to_r0" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates r0 from seeing</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>seeing</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – seeing angle in arcseconds</li>
<li><strong>lamda</strong> – wavelength</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Freid’s parameter in cm</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">r0 (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)">float</a>)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="aotools.turbulence.atmos_conversions.slope_variance_from_r0">
<code class="descclassname">aotools.turbulence.atmos_conversions.</code><code class="descname">slope_variance_from_r0</code><span class="sig-paren">(</span><em>r0</em>, <em>wavelength</em>, <em>subapDiam</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/aotools/turbulence/atmos_conversions.html#slope_variance_from_r0"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aotools.turbulence.atmos_conversions.slope_variance_from_r0" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the expected slope variance for a given r0 ValueError</p>
<p>Uses the equation in Saint Jaques, 1998, PhD Thesis, Appendix A to calculate the slope variance resulting from a value of r0.</p>
</dd></dl>

</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="image_processing.html" class="btn btn-neutral float-right" title="Image Processing" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="introduction.html" class="btn btn-neutral" title="Introduction" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Centre for Advanced Instrumentation.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>